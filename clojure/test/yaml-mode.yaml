# Copyright 2023 Ingy dot Net
# This code is licensed under MIT license (See License for details)

- name: yaml-mode mapping
  yamlscript: |
    foo: 42
    bar: 3.1415
    baz: true
  resolve: |
    {:map
     [{:str "foo"}
      {:int "42"}
      {:str "bar"}
      {:flt "3.1415"}
      {:str "baz"}
      {:bln "true"}]}
  build: |
    {:Map
     [{:Str "foo"}
      {:Int 42}
      {:Str "bar"}
      {:Flt 3.1415}
      {:Str "baz"}
      {:Bln true}]}
  print: |
    {"foo" 42, "bar" 3.1415, "baz" true}

- name: yaml-mode sequence
  yamlscript: |
    - foo
    - 42
    - 3.1415
    - true
    - false
    - null
    - ~
    -
  resolve: |
    {:seq
     [{:str "foo"}
      {:int "42"}
      {:flt "3.1415"}
      {:bln "true"}
      {:bln "false"}
      {:null "null"}
      {:null "~"}
      {:null ""}]}
  build: |
    {:Vec
     [{:Str "foo"}
      {:Int 42}
      {:Flt 3.1415}
      {:Bln true}
      {:Bln false}
      {:Nil nil}
      {:Nil nil}
      {:Nil nil}]}
  print: |
    ["foo" 42 3.1415 true false nil nil nil]

- name: yaml-mode nested collections
  yamlscript: |
    foo:
    - -42
    - bar: 3.1415
      baz:
      - True
      - False
      - :string
  print: |
    {"foo" [-42 {"bar" 3.1415, "baz" [true false ":string"]}]}

- name: Empty YAMLScript File
  yamlscript: ""
  build: |
    {:Empty nil}
  print: |

- name: Empty YAMLScript File w/ yamlscript Tag
  yamlscript: ""
  build: |
    {:Empty nil}
  print: |

- name: yaml-mode with script-mode
  yamlscript: |
    !yamlscript/0
    foo: !ys inc(41)
    bar: ! dec(43)
  print: |
    {"foo" (inc 41), "bar" (dec 43)}
  SKIP: true
